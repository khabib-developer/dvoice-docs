---
title: Использование SDK
description: Как использовать SDK DVoice TTS для единичных и потоковых конечных точек, с планами на будущую поддержку STT.
---

# Использование SDK

SDK DVoice TTS упрощает интеграцию с API TTS, предоставляя методы для генерации одиночных аудиофайлов и потоковой передачи в реальном времени. На данный момент SDK поддерживает только конечные точки TTS, с планами включить функциональность преобразования речи в текст (STT) в будущих обновлениях. SDK доступен для Node.js и Python.

## Установка

### Node.js

Установите SDK с помощью npm:

```bash
npm install dvoice-tts
```

### Python

Установите SDK с помощью pip:

```bash
pip install dvoice-tts
```

## Инициализация

SDK требует API-токен для аутентификации, который можно получить из [Аутентификации](../get-started/authentication).

### Node.js

```javascript
const { TTS } = require("dvoice-tts");

const client = new TTS({ token: "<your-token>" });
```

### Python

```python
from dvoice_tts import TTS

client = TTS(token='<your-token>')
```

## Методы

### Метод `single`

Генерирует одиночный аудиофайл из текста через HTTP-запрос POST.

#### Параметры

| Поле   | Тип    | Описание                             | Обязательно |
| ------ | ------ | ------------------------------------ | ----------- |
| text   | string | Текст для преобразования в речь      | Да          |
| model  | string | Модель голоса (например, "Iroda")    | Да          |
| format | string | Аудиоформат (например, "mp3", "wav") | Да          |

#### Возвращает

- `Promise<Buffer>`: Аудиоданные в виде Buffer.

#### Пример (Node.js)

```javascript
const { TTS } = require("dvoice-tts");

const client = new TTS({ token: "<your-token>" });

async function generateSingleAudio() {
  try {
    const audioBuffer = await client.single({
      text: "Haq olinur, berilmas",
      model: "Iroda",
      format: "mp3",
    });
    require("fs").writeFileSync("output.mp3", audioBuffer);
    console.log("Аудио сохранено в output.mp3");
  } catch (error) {
    console.error("Ошибка:", error.message);
  }
}

generateSingleAudio();
```

#### Пример (Python)

```python
from dvoice_tts import TTS

client = TTS(token='<your-token>')

try:
    audio_data = client.single(
        text='Haq olinur, berilmas',
        model='Iroda',
        format='mp3'
    )
    with open('output.mp3', 'wb') as f:
        f.write(audio_data)
    print('Аудио сохранено в output.mp3')
except Exception as e:
    print('Ошибка:', str(e))
```

### Метод `stream`

Передает аудио в реальном времени через WebSocket для приложений с низкой задержкой.

#### Параметры

| Поле   | Тип    | Описание                             | Обязательно |
| ------ | ------ | ------------------------------------ | ----------- |
| text   | string | Текст для преобразования в речь      | Да          |
| model  | string | Модель голоса (например, "Iroda")    | Да          |
| format | string | Аудиоформат (например, "mp3", "wav") | Да          |

#### Обратный вызов

- `err: Error | null`: Ошибка, если поток не удался.
- `chunk: Buffer | null`: Аудио-фрагмент или null, если поток завершён.
- `close: () => void`: Функция для закрытия WebSocket-соединения.

#### Пример (Node.js)

```javascript
const { TTS } = require("dvoice-tts");
const fs = require("fs");

const client = new TTS({ token: "<your-token>" });

client.stream(
  {
    text: "Haq olinur, berilmas",
    model: "Iroda",
    format: "mp3",
  },
  (err, chunk, close) => {
    if (err) {
      console.error("Ошибка:", err.message);
      close();
      return;
    }
    if (chunk) {
      console.log("Получен аудио-фрагмент:", chunk.length, "байтов");
      fs.appendFileSync("output.mp3", chunk);
    } else {
      console.log("Поток завершен");
      close();
    }
  }
);
```

#### Пример (Python)

```python
from dvoice_tts import TTS

client = TTS(token='<your-token>')

def handle_stream(err, chunk, close):
    if err:
        print('Ошибка:', err)
        close()
        return
    if chunk:
        print(f'Получен аудио-фрагмент: {len(chunk)} байтов')
        with open('output.mp3', 'ab') as f:
            f.write(chunk)
    else:
        print('Поток завершен')
        close()

client.stream(
    text='Haq olinur, berilmas',
    model='Iroda',
    format='mp3',
    callback=handle_stream
)
```

## Примечания

- Метод `single` требует HTTPS-агента для безопасных соединений (обработка выполняется автоматически в SDK).
- Метод `stream` использует WebSocket (`ws://oyqiz.airi.uz/stream`) с параметрами запроса для `text`, `model` и `format`.
- Тарификация основана на длине текста для обоих методов.
- Будущие обновления включат поддержку STT, расширяя возможности SDK.

<Callout type="warning">
  Убедитесь, что ваш API-токен действителен и надежно сохранен, чтобы избежать
  ошибок `403 Forbidden`.
</Callout>
